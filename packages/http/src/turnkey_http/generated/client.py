# @generated by codegen. DO NOT EDIT BY HAND

import json
import time
from typing import Any, Callable, Dict, Optional, TypeVar, overload
import requests
from turnkey_api_key_stamper import ApiKeyStamper
from turnkey_sdk_types import *
from ..version import VERSION

T = TypeVar("T")

TERMINAL_ACTIVITY_STATUSES = [
    "ACTIVITY_STATUS_COMPLETED",
    "ACTIVITY_STATUS_FAILED",
    "ACTIVITY_STATUS_CONSENSUS_NEEDED",
    "ACTIVITY_STATUS_REJECTED",
]


class TurnkeyClient:
    """Turnkey API HTTP client with auto-generated methods."""

    def __init__(
        self,
        base_url: str,
        stamper: ApiKeyStamper,
        organization_id: str,
        default_timeout: int = 30,
        polling_interval_ms: int = 1000,
        max_polling_retries: int = 3,
    ):
        """Initialize the Turnkey client.

        Args:
            base_url: Base URL for the Turnkey API
            stamper: API key stamper for authentication
            organization_id: Organization ID
            default_timeout: Default request timeout in seconds
            polling_interval_ms: Polling interval for activity status in milliseconds
            max_polling_retries: Maximum number of polling retries
        """
        self.base_url = base_url.rstrip("/")
        self.stamper = stamper
        self.organization_id = organization_id
        self.default_timeout = default_timeout
        self.polling_interval_ms = polling_interval_ms
        self.max_polling_retries = max_polling_retries

    def _serialize_body(self, body: Any) -> str:
        """Serialize request body, handling Pydantic models recursively.

        Args:
            body: Request body (dict, Pydantic model, list, or primitive)

        Returns:
            JSON string
        """

        def serialize_value(value):
            """Recursively serialize values, converting Pydantic models to dicts."""
            if hasattr(value, "model_dump"):
                return value.model_dump(by_alias=True, exclude_none=True)
            elif isinstance(value, dict):
                return {k: serialize_value(v) for k, v in value.items()}
            elif isinstance(value, list):
                return [serialize_value(item) for item in value]
            else:
                return value

        serialized = serialize_value(body)
        return json.dumps(serialized)

    def _request(self, url: str, body: Dict[str, Any], response_type: type) -> Any:
        """Make a request to the Turnkey API.

        Args:
            url: Endpoint URL
            body: Request body
            response_type: Pydantic model class for response parsing

        Returns:
            Parsed response as Pydantic model

        Raises:
            TurnkeyNetworkError: If request fails
        """
        full_url = self.base_url + url
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        headers = {
            stamp.stamp_header_name: stamp.stamp_header_value,
            "Content-Type": "application/json",
            "X-Client-Version": VERSION,
        }

        try:
            response = requests.post(
                full_url, headers=headers, data=body_str, timeout=self.default_timeout
            )
        except requests.RequestException as exc:
            raise TurnkeyNetworkError(
                "Request failed", None, TurnkeyErrorCodes.NETWORK_ERROR, str(exc)
            ) from exc

        if not response.ok:
            try:
                error_data = response.json()
                error_message = error_data.get("message", str(error_data))
            except ValueError:
                error_message = (
                    response.text or f"{response.status_code} {response.reason}"
                )

            raise TurnkeyNetworkError(
                error_message,
                response.status_code,
                TurnkeyErrorCodes.BAD_RESPONSE,
                response.text,
            )

        response_data = response.json()
        return response_type(**response_data)

    def _poll_for_completion(self, activity: Any) -> Any:
        """Poll until activity reaches terminal status.

        Args:
            activity: Initial activity object with id and status attributes.

        Returns:
            Activity object after reaching terminal status or max retries.
        """
        if activity.status in TERMINAL_ACTIVITY_STATUSES:
            return activity

        attempts = 0
        while attempts < self.max_polling_retries:
            time.sleep(self.polling_interval_ms / 1000.0)
            poll_response = self.get_activity(GetActivityBody(activityId=activity.id))
            activity = poll_response.activity
            if activity.status in TERMINAL_ACTIVITY_STATUSES:
                break
            attempts += 1

        return activity

    def _activity(
        self, url: str, body: Dict[str, Any], result_key: str, response_type: type
    ) -> Any:
        """Execute an activity and poll for completion.

        Args:
            url: Endpoint URL
            body: Request body
            result_key: Key to extract result from activity when completed
            response_type: Pydantic model class for response parsing

        Returns:
            Parsed response as Pydantic model with flattened result fields
        """
        # Make initial request, we parse as activity response without result fields
        initial_response = self._request(url, body, GetActivityResponse)

        # Poll for completion
        activity = self._poll_for_completion(initial_response.activity)

        # If activity completed successfully, flatten result fields into response
        if (
            activity.status == "ACTIVITY_STATUS_COMPLETED"
            and hasattr(activity, "result")
            and activity.result
        ):
            result = activity.result
            # Get the versioned result key (e.g., 'createApiKeysResultV2')
            if hasattr(result, result_key):
                result_data = getattr(result, result_key)
                if result_data and hasattr(result_data, "model_dump"):
                    # Flatten result fields into response
                    result_dict = result_data.model_dump(
                        by_alias=True, exclude_none=True
                    )
                    # Construct final response with activity and result fields
                    response = response_type(activity=activity, **result_dict)
                    return response

        # Return response with just the activity (no result fields)
        return response_type(activity=activity)

    def _activity_decision(
        self, url: str, body: Dict[str, Any], response_type: type
    ) -> Any:
        """Execute an activity decision.

        Args:
            url: Endpoint URL
            body: Request body
            response_type: Pydantic model class for response parsing

        Returns:
            Parsed response as Pydantic model
        """
        return self._request(url, body, response_type)

    @overload
    def send_signed_request(
        self, signed_request: SignedRequest, response_type: type[T]
    ) -> T: ...

    @overload
    def send_signed_request(self, signed_request: SignedRequest) -> Any: ...

    def send_signed_request(
        self, signed_request: SignedRequest, response_type: type[T] | None = None
    ) -> Any:
        """Submit a signed request and poll for activity completion if needed.

        You can pass in the SignedRequest returned by any of the SDK's
        stamping methods (stamp_create_api_keys, stamp_get_policies, etc.).

        For activities, this will poll until the activity reaches a terminal status.

        Args:
            signed_request: A SignedRequest object returned by a stamping method.
            response_type: Optional callable to convert the JSON payload to a typed value.
                          Typically a Pydantic model class.

        Returns:
            The parsed response via response_type, or raw JSON dict if no type provided.

        Raises:
            TurnkeyNetworkError: If the request fails.
        """
        headers = {
            signed_request.stamp.stamp_header_name: signed_request.stamp.stamp_header_value,
            "Content-Type": "application/json",
            "X-Client-Version": VERSION,
        }

        try:
            response = requests.post(
                signed_request.url,
                headers=headers,
                data=signed_request.body,
                timeout=self.default_timeout,
            )
        except requests.RequestException as exc:
            raise TurnkeyNetworkError(
                "Signed request failed", None, TurnkeyErrorCodes.NETWORK_ERROR, str(exc)
            ) from exc

        if not response.ok:
            try:
                error_data = response.json()
                error_message = error_data.get("message", str(error_data))
            except ValueError:
                error_message = (
                    response.text or f"{response.status_code} {response.reason}"
                )

            raise TurnkeyNetworkError(
                error_message,
                response.status_code,
                TurnkeyErrorCodes.BAD_RESPONSE,
                response.text,
            )

        payload = response.json()

        # Poll for activity completion if this is an activity request
        if signed_request.type == RequestType.ACTIVITY:
            activity_response = GetActivityResponse(**payload)
            activity = self._poll_for_completion(activity_response.activity)

            # Update payload with polled activity
            activity_dict = (
                activity.model_dump(by_alias=True, exclude_none=True)
                if hasattr(activity, "model_dump")
                else {}
            )
            payload["activity"] = activity_dict

            # Extract result fields if activity completed successfully
            if (
                activity.status == "ACTIVITY_STATUS_COMPLETED"
                and hasattr(activity, "result")
                and activity.result
            ):
                result = activity.result
                # Find the first result field (e.g., createApiKeysResult, createPolicyResult, etc.)
                for attr_name in dir(result):
                    if not attr_name.startswith("_") and attr_name.endswith("Result"):
                        result_data = getattr(result, attr_name, None)
                        if result_data and hasattr(result_data, "model_dump"):
                            # Flatten result fields into payload
                            result_dict = result_data.model_dump(
                                by_alias=True, exclude_none=True
                            )
                            payload.update(result_dict)
                            break

        return response_type(**payload) if response_type is not None else payload

    def get_activity(self, input: GetActivityBody) -> GetActivityResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request("/public/v1/query/get_activity", body, GetActivityResponse)

    def stamp_get_activity(self, input: GetActivityBody) -> SignedRequest:
        """Stamp a getActivity request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_activity"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_api_key(self, input: GetApiKeyBody) -> GetApiKeyResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request("/public/v1/query/get_api_key", body, GetApiKeyResponse)

    def stamp_get_api_key(self, input: GetApiKeyBody) -> SignedRequest:
        """Stamp a getApiKey request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_api_key"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_api_keys(
        self, input: Optional[GetApiKeysBody] = None
    ) -> GetApiKeysResponse:
        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request("/public/v1/query/get_api_keys", body, GetApiKeysResponse)

    def stamp_get_api_keys(
        self, input: Optional[GetApiKeysBody] = None
    ) -> SignedRequest:
        """Stamp a getApiKeys request without sending it."""

        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_api_keys"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_attestation_document(
        self, input: GetAttestationDocumentBody
    ) -> GetAttestationDocumentResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_attestation", body, GetAttestationDocumentResponse
        )

    def stamp_get_attestation_document(
        self, input: GetAttestationDocumentBody
    ) -> SignedRequest:
        """Stamp a getAttestationDocument request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_attestation"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_authenticator(
        self, input: GetAuthenticatorBody
    ) -> GetAuthenticatorResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_authenticator", body, GetAuthenticatorResponse
        )

    def stamp_get_authenticator(self, input: GetAuthenticatorBody) -> SignedRequest:
        """Stamp a getAuthenticator request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_authenticator"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_authenticators(
        self, input: GetAuthenticatorsBody
    ) -> GetAuthenticatorsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_authenticators", body, GetAuthenticatorsResponse
        )

    def stamp_get_authenticators(self, input: GetAuthenticatorsBody) -> SignedRequest:
        """Stamp a getAuthenticators request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_authenticators"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_boot_proof(self, input: GetBootProofBody) -> GetBootProofResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_boot_proof", body, GetBootProofResponse
        )

    def stamp_get_boot_proof(self, input: GetBootProofBody) -> SignedRequest:
        """Stamp a getBootProof request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_boot_proof"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_gas_usage(self, input: GetGasUsageBody) -> GetGasUsageResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_gas_usage", body, GetGasUsageResponse
        )

    def stamp_get_gas_usage(self, input: GetGasUsageBody) -> SignedRequest:
        """Stamp a getGasUsage request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_gas_usage"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_latest_boot_proof(
        self, input: GetLatestBootProofBody
    ) -> GetLatestBootProofResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_latest_boot_proof", body, GetLatestBootProofResponse
        )

    def stamp_get_latest_boot_proof(
        self, input: GetLatestBootProofBody
    ) -> SignedRequest:
        """Stamp a getLatestBootProof request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_latest_boot_proof"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_nonces(self, input: GetNoncesBody) -> GetNoncesResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request("/public/v1/query/get_nonces", body, GetNoncesResponse)

    def stamp_get_nonces(self, input: GetNoncesBody) -> SignedRequest:
        """Stamp a getNonces request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_nonces"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_oauth2_credential(
        self, input: GetOauth2CredentialBody
    ) -> GetOauth2CredentialResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_oauth2_credential", body, GetOauth2CredentialResponse
        )

    def stamp_get_oauth2_credential(
        self, input: GetOauth2CredentialBody
    ) -> SignedRequest:
        """Stamp a getOauth2Credential request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_oauth2_credential"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_oauth_providers(
        self, input: GetOauthProvidersBody
    ) -> GetOauthProvidersResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_oauth_providers", body, GetOauthProvidersResponse
        )

    def stamp_get_oauth_providers(self, input: GetOauthProvidersBody) -> SignedRequest:
        """Stamp a getOauthProviders request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_oauth_providers"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_on_ramp_transaction_status(
        self, input: GetOnRampTransactionStatusBody
    ) -> GetOnRampTransactionStatusResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_onramp_transaction_status",
            body,
            GetOnRampTransactionStatusResponse,
        )

    def stamp_get_on_ramp_transaction_status(
        self, input: GetOnRampTransactionStatusBody
    ) -> SignedRequest:
        """Stamp a getOnRampTransactionStatus request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_onramp_transaction_status"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_organization(
        self, input: Optional[GetOrganizationBody] = None
    ) -> GetOrganizationResponse:
        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_organization", body, GetOrganizationResponse
        )

    def stamp_get_organization(
        self, input: Optional[GetOrganizationBody] = None
    ) -> SignedRequest:
        """Stamp a getOrganization request without sending it."""

        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_organization"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_organization_configs(
        self, input: GetOrganizationConfigsBody
    ) -> GetOrganizationConfigsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_organization_configs",
            body,
            GetOrganizationConfigsResponse,
        )

    def stamp_get_organization_configs(
        self, input: GetOrganizationConfigsBody
    ) -> SignedRequest:
        """Stamp a getOrganizationConfigs request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_organization_configs"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_policy(self, input: GetPolicyBody) -> GetPolicyResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request("/public/v1/query/get_policy", body, GetPolicyResponse)

    def stamp_get_policy(self, input: GetPolicyBody) -> SignedRequest:
        """Stamp a getPolicy request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_policy"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_policy_evaluations(
        self, input: GetPolicyEvaluationsBody
    ) -> GetPolicyEvaluationsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_policy_evaluations",
            body,
            GetPolicyEvaluationsResponse,
        )

    def stamp_get_policy_evaluations(
        self, input: GetPolicyEvaluationsBody
    ) -> SignedRequest:
        """Stamp a getPolicyEvaluations request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_policy_evaluations"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_private_key(self, input: GetPrivateKeyBody) -> GetPrivateKeyResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_private_key", body, GetPrivateKeyResponse
        )

    def stamp_get_private_key(self, input: GetPrivateKeyBody) -> SignedRequest:
        """Stamp a getPrivateKey request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_private_key"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_send_transaction_status(
        self, input: GetSendTransactionStatusBody
    ) -> GetSendTransactionStatusResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_send_transaction_status",
            body,
            GetSendTransactionStatusResponse,
        )

    def stamp_get_send_transaction_status(
        self, input: GetSendTransactionStatusBody
    ) -> SignedRequest:
        """Stamp a getSendTransactionStatus request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_send_transaction_status"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_smart_contract_interface(
        self, input: GetSmartContractInterfaceBody
    ) -> GetSmartContractInterfaceResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_smart_contract_interface",
            body,
            GetSmartContractInterfaceResponse,
        )

    def stamp_get_smart_contract_interface(
        self, input: GetSmartContractInterfaceBody
    ) -> SignedRequest:
        """Stamp a getSmartContractInterface request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_smart_contract_interface"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_user(self, input: GetUserBody) -> GetUserResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request("/public/v1/query/get_user", body, GetUserResponse)

    def stamp_get_user(self, input: GetUserBody) -> SignedRequest:
        """Stamp a getUser request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_user"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_wallet(self, input: GetWalletBody) -> GetWalletResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request("/public/v1/query/get_wallet", body, GetWalletResponse)

    def stamp_get_wallet(self, input: GetWalletBody) -> SignedRequest:
        """Stamp a getWallet request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_wallet"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_wallet_account(
        self, input: GetWalletAccountBody
    ) -> GetWalletAccountResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/get_wallet_account", body, GetWalletAccountResponse
        )

    def stamp_get_wallet_account(self, input: GetWalletAccountBody) -> SignedRequest:
        """Stamp a getWalletAccount request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/get_wallet_account"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_activities(
        self, input: Optional[GetActivitiesBody] = None
    ) -> GetActivitiesResponse:
        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/list_activities", body, GetActivitiesResponse
        )

    def stamp_get_activities(
        self, input: Optional[GetActivitiesBody] = None
    ) -> SignedRequest:
        """Stamp a getActivities request without sending it."""

        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/list_activities"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_app_proofs(self, input: GetAppProofsBody) -> GetAppProofsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/list_app_proofs", body, GetAppProofsResponse
        )

    def stamp_get_app_proofs(self, input: GetAppProofsBody) -> SignedRequest:
        """Stamp a getAppProofs request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/list_app_proofs"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def list_fiat_on_ramp_credentials(
        self, input: ListFiatOnRampCredentialsBody
    ) -> ListFiatOnRampCredentialsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/list_fiat_on_ramp_credentials",
            body,
            ListFiatOnRampCredentialsResponse,
        )

    def stamp_list_fiat_on_ramp_credentials(
        self, input: ListFiatOnRampCredentialsBody
    ) -> SignedRequest:
        """Stamp a listFiatOnRampCredentials request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/list_fiat_on_ramp_credentials"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def list_oauth2_credentials(
        self, input: ListOauth2CredentialsBody
    ) -> ListOauth2CredentialsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/list_oauth2_credentials",
            body,
            ListOauth2CredentialsResponse,
        )

    def stamp_list_oauth2_credentials(
        self, input: ListOauth2CredentialsBody
    ) -> SignedRequest:
        """Stamp a listOauth2Credentials request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/list_oauth2_credentials"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_policies(
        self, input: Optional[GetPoliciesBody] = None
    ) -> GetPoliciesResponse:
        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/list_policies", body, GetPoliciesResponse
        )

    def stamp_get_policies(
        self, input: Optional[GetPoliciesBody] = None
    ) -> SignedRequest:
        """Stamp a getPolicies request without sending it."""

        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/list_policies"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def list_private_key_tags(
        self, input: ListPrivateKeyTagsBody
    ) -> ListPrivateKeyTagsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/list_private_key_tags", body, ListPrivateKeyTagsResponse
        )

    def stamp_list_private_key_tags(
        self, input: ListPrivateKeyTagsBody
    ) -> SignedRequest:
        """Stamp a listPrivateKeyTags request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/list_private_key_tags"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_private_keys(
        self, input: Optional[GetPrivateKeysBody] = None
    ) -> GetPrivateKeysResponse:
        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/list_private_keys", body, GetPrivateKeysResponse
        )

    def stamp_get_private_keys(
        self, input: Optional[GetPrivateKeysBody] = None
    ) -> SignedRequest:
        """Stamp a getPrivateKeys request without sending it."""

        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/list_private_keys"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_smart_contract_interfaces(
        self, input: GetSmartContractInterfacesBody
    ) -> GetSmartContractInterfacesResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/list_smart_contract_interfaces",
            body,
            GetSmartContractInterfacesResponse,
        )

    def stamp_get_smart_contract_interfaces(
        self, input: GetSmartContractInterfacesBody
    ) -> SignedRequest:
        """Stamp a getSmartContractInterfaces request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/list_smart_contract_interfaces"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_sub_org_ids(
        self, input: Optional[GetSubOrgIdsBody] = None
    ) -> GetSubOrgIdsResponse:
        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/list_suborgs", body, GetSubOrgIdsResponse
        )

    def stamp_get_sub_org_ids(
        self, input: Optional[GetSubOrgIdsBody] = None
    ) -> SignedRequest:
        """Stamp a getSubOrgIds request without sending it."""

        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/list_suborgs"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def list_user_tags(
        self, input: Optional[ListUserTagsBody] = None
    ) -> ListUserTagsResponse:
        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/list_user_tags", body, ListUserTagsResponse
        )

    def stamp_list_user_tags(
        self, input: Optional[ListUserTagsBody] = None
    ) -> SignedRequest:
        """Stamp a listUserTags request without sending it."""

        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/list_user_tags"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_users(self, input: Optional[GetUsersBody] = None) -> GetUsersResponse:
        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request("/public/v1/query/list_users", body, GetUsersResponse)

    def stamp_get_users(self, input: Optional[GetUsersBody] = None) -> SignedRequest:
        """Stamp a getUsers request without sending it."""

        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/list_users"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_verified_sub_org_ids(
        self, input: GetVerifiedSubOrgIdsBody
    ) -> GetVerifiedSubOrgIdsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/list_verified_suborgs", body, GetVerifiedSubOrgIdsResponse
        )

    def stamp_get_verified_sub_org_ids(
        self, input: GetVerifiedSubOrgIdsBody
    ) -> SignedRequest:
        """Stamp a getVerifiedSubOrgIds request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/list_verified_suborgs"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_wallet_accounts(
        self, input: GetWalletAccountsBody
    ) -> GetWalletAccountsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/public/v1/query/list_wallet_accounts", body, GetWalletAccountsResponse
        )

    def stamp_get_wallet_accounts(self, input: GetWalletAccountsBody) -> SignedRequest:
        """Stamp a getWalletAccounts request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/list_wallet_accounts"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_wallets(self, input: Optional[GetWalletsBody] = None) -> GetWalletsResponse:
        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request("/public/v1/query/list_wallets", body, GetWalletsResponse)

    def stamp_get_wallets(
        self, input: Optional[GetWalletsBody] = None
    ) -> SignedRequest:
        """Stamp a getWallets request without sending it."""

        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/list_wallets"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def get_whoami(self, input: Optional[GetWhoamiBody] = None) -> GetWhoamiResponse:
        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request("/public/v1/query/whoami", body, GetWhoamiResponse)

    def stamp_get_whoami(self, input: Optional[GetWhoamiBody] = None) -> SignedRequest:
        """Stamp a getWhoami request without sending it."""

        if input is None:
            input_dict = {}
        else:
            # Convert Pydantic model to dict
            input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/public/v1/query/whoami"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )

    def approve_activity(self, input: ApproveActivityBody) -> ApproveActivityResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_APPROVE_ACTIVITY",
        }

        return self._activity_decision(
            "/public/v1/submit/approve_activity", body, ApproveActivityResponse
        )

    def stamp_approve_activity(self, input: ApproveActivityBody) -> SignedRequest:
        """Stamp a approveActivity request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_APPROVE_ACTIVITY",
        }

        full_url = self.base_url + "/public/v1/submit/approve_activity"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY_DECISION
        )

    def create_api_keys(self, input: CreateApiKeysBody) -> CreateApiKeysResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_API_KEYS_V2",
        }

        return self._activity(
            "/public/v1/submit/create_api_keys",
            body,
            "createApiKeysResult",
            CreateApiKeysResponse,
        )

    def stamp_create_api_keys(self, input: CreateApiKeysBody) -> SignedRequest:
        """Stamp a createApiKeys request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_API_KEYS_V2",
        }

        full_url = self.base_url + "/public/v1/submit/create_api_keys"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_api_only_users(
        self, input: CreateApiOnlyUsersBody
    ) -> CreateApiOnlyUsersResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_API_ONLY_USERS",
        }

        return self._activity(
            "/public/v1/submit/create_api_only_users",
            body,
            "createApiOnlyUsersResult",
            CreateApiOnlyUsersResponse,
        )

    def stamp_create_api_only_users(
        self, input: CreateApiOnlyUsersBody
    ) -> SignedRequest:
        """Stamp a createApiOnlyUsers request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_API_ONLY_USERS",
        }

        full_url = self.base_url + "/public/v1/submit/create_api_only_users"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_authenticators(
        self, input: CreateAuthenticatorsBody
    ) -> CreateAuthenticatorsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_AUTHENTICATORS_V2",
        }

        return self._activity(
            "/public/v1/submit/create_authenticators",
            body,
            "createAuthenticatorsResult",
            CreateAuthenticatorsResponse,
        )

    def stamp_create_authenticators(
        self, input: CreateAuthenticatorsBody
    ) -> SignedRequest:
        """Stamp a createAuthenticators request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_AUTHENTICATORS_V2",
        }

        full_url = self.base_url + "/public/v1/submit/create_authenticators"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_fiat_on_ramp_credential(
        self, input: CreateFiatOnRampCredentialBody
    ) -> CreateFiatOnRampCredentialResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_FIAT_ON_RAMP_CREDENTIAL",
        }

        return self._activity(
            "/public/v1/submit/create_fiat_on_ramp_credential",
            body,
            "createFiatOnRampCredentialResult",
            CreateFiatOnRampCredentialResponse,
        )

    def stamp_create_fiat_on_ramp_credential(
        self, input: CreateFiatOnRampCredentialBody
    ) -> SignedRequest:
        """Stamp a createFiatOnRampCredential request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_FIAT_ON_RAMP_CREDENTIAL",
        }

        full_url = self.base_url + "/public/v1/submit/create_fiat_on_ramp_credential"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_invitations(
        self, input: CreateInvitationsBody
    ) -> CreateInvitationsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_INVITATIONS",
        }

        return self._activity(
            "/public/v1/submit/create_invitations",
            body,
            "createInvitationsResult",
            CreateInvitationsResponse,
        )

    def stamp_create_invitations(self, input: CreateInvitationsBody) -> SignedRequest:
        """Stamp a createInvitations request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_INVITATIONS",
        }

        full_url = self.base_url + "/public/v1/submit/create_invitations"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_oauth2_credential(
        self, input: CreateOauth2CredentialBody
    ) -> CreateOauth2CredentialResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_OAUTH2_CREDENTIAL",
        }

        return self._activity(
            "/public/v1/submit/create_oauth2_credential",
            body,
            "createOauth2CredentialResult",
            CreateOauth2CredentialResponse,
        )

    def stamp_create_oauth2_credential(
        self, input: CreateOauth2CredentialBody
    ) -> SignedRequest:
        """Stamp a createOauth2Credential request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_OAUTH2_CREDENTIAL",
        }

        full_url = self.base_url + "/public/v1/submit/create_oauth2_credential"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_oauth_providers(
        self, input: CreateOauthProvidersBody
    ) -> CreateOauthProvidersResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_OAUTH_PROVIDERS",
        }

        return self._activity(
            "/public/v1/submit/create_oauth_providers",
            body,
            "createOauthProvidersResult",
            CreateOauthProvidersResponse,
        )

    def stamp_create_oauth_providers(
        self, input: CreateOauthProvidersBody
    ) -> SignedRequest:
        """Stamp a createOauthProviders request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_OAUTH_PROVIDERS",
        }

        full_url = self.base_url + "/public/v1/submit/create_oauth_providers"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_policies(self, input: CreatePoliciesBody) -> CreatePoliciesResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_POLICIES",
        }

        return self._activity(
            "/public/v1/submit/create_policies",
            body,
            "createPoliciesResult",
            CreatePoliciesResponse,
        )

    def stamp_create_policies(self, input: CreatePoliciesBody) -> SignedRequest:
        """Stamp a createPolicies request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_POLICIES",
        }

        full_url = self.base_url + "/public/v1/submit/create_policies"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_policy(self, input: CreatePolicyBody) -> CreatePolicyResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_POLICY_V3",
        }

        return self._activity(
            "/public/v1/submit/create_policy",
            body,
            "createPolicyResult",
            CreatePolicyResponse,
        )

    def stamp_create_policy(self, input: CreatePolicyBody) -> SignedRequest:
        """Stamp a createPolicy request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_POLICY_V3",
        }

        full_url = self.base_url + "/public/v1/submit/create_policy"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_private_key_tag(
        self, input: CreatePrivateKeyTagBody
    ) -> CreatePrivateKeyTagResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_PRIVATE_KEY_TAG",
        }

        return self._activity(
            "/public/v1/submit/create_private_key_tag",
            body,
            "createPrivateKeyTagResult",
            CreatePrivateKeyTagResponse,
        )

    def stamp_create_private_key_tag(
        self, input: CreatePrivateKeyTagBody
    ) -> SignedRequest:
        """Stamp a createPrivateKeyTag request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_PRIVATE_KEY_TAG",
        }

        full_url = self.base_url + "/public/v1/submit/create_private_key_tag"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_private_keys(
        self, input: CreatePrivateKeysBody
    ) -> CreatePrivateKeysResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_PRIVATE_KEYS_V2",
        }

        return self._activity(
            "/public/v1/submit/create_private_keys",
            body,
            "createPrivateKeysResultV2",
            CreatePrivateKeysResponse,
        )

    def stamp_create_private_keys(self, input: CreatePrivateKeysBody) -> SignedRequest:
        """Stamp a createPrivateKeys request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_PRIVATE_KEYS_V2",
        }

        full_url = self.base_url + "/public/v1/submit/create_private_keys"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_read_only_session(
        self, input: CreateReadOnlySessionBody
    ) -> CreateReadOnlySessionResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_READ_ONLY_SESSION",
        }

        return self._activity(
            "/public/v1/submit/create_read_only_session",
            body,
            "createReadOnlySessionResult",
            CreateReadOnlySessionResponse,
        )

    def stamp_create_read_only_session(
        self, input: CreateReadOnlySessionBody
    ) -> SignedRequest:
        """Stamp a createReadOnlySession request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_READ_ONLY_SESSION",
        }

        full_url = self.base_url + "/public/v1/submit/create_read_only_session"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_read_write_session(
        self, input: CreateReadWriteSessionBody
    ) -> CreateReadWriteSessionResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_READ_WRITE_SESSION_V2",
        }

        return self._activity(
            "/public/v1/submit/create_read_write_session",
            body,
            "createReadWriteSessionResultV2",
            CreateReadWriteSessionResponse,
        )

    def stamp_create_read_write_session(
        self, input: CreateReadWriteSessionBody
    ) -> SignedRequest:
        """Stamp a createReadWriteSession request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_READ_WRITE_SESSION_V2",
        }

        full_url = self.base_url + "/public/v1/submit/create_read_write_session"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_smart_contract_interface(
        self, input: CreateSmartContractInterfaceBody
    ) -> CreateSmartContractInterfaceResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_SMART_CONTRACT_INTERFACE",
        }

        return self._activity(
            "/public/v1/submit/create_smart_contract_interface",
            body,
            "createSmartContractInterfaceResult",
            CreateSmartContractInterfaceResponse,
        )

    def stamp_create_smart_contract_interface(
        self, input: CreateSmartContractInterfaceBody
    ) -> SignedRequest:
        """Stamp a createSmartContractInterface request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_SMART_CONTRACT_INTERFACE",
        }

        full_url = self.base_url + "/public/v1/submit/create_smart_contract_interface"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_sub_organization(
        self, input: CreateSubOrganizationBody
    ) -> CreateSubOrganizationResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_SUB_ORGANIZATION_V7",
        }

        return self._activity(
            "/public/v1/submit/create_sub_organization",
            body,
            "createSubOrganizationResultV7",
            CreateSubOrganizationResponse,
        )

    def stamp_create_sub_organization(
        self, input: CreateSubOrganizationBody
    ) -> SignedRequest:
        """Stamp a createSubOrganization request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_SUB_ORGANIZATION_V7",
        }

        full_url = self.base_url + "/public/v1/submit/create_sub_organization"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_user_tag(self, input: CreateUserTagBody) -> CreateUserTagResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_USER_TAG",
        }

        return self._activity(
            "/public/v1/submit/create_user_tag",
            body,
            "createUserTagResult",
            CreateUserTagResponse,
        )

    def stamp_create_user_tag(self, input: CreateUserTagBody) -> SignedRequest:
        """Stamp a createUserTag request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_USER_TAG",
        }

        full_url = self.base_url + "/public/v1/submit/create_user_tag"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_users(self, input: CreateUsersBody) -> CreateUsersResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_USERS_V3",
        }

        return self._activity(
            "/public/v1/submit/create_users",
            body,
            "createUsersResult",
            CreateUsersResponse,
        )

    def stamp_create_users(self, input: CreateUsersBody) -> SignedRequest:
        """Stamp a createUsers request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_USERS_V3",
        }

        full_url = self.base_url + "/public/v1/submit/create_users"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_wallet(self, input: CreateWalletBody) -> CreateWalletResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_WALLET",
        }

        return self._activity(
            "/public/v1/submit/create_wallet",
            body,
            "createWalletResult",
            CreateWalletResponse,
        )

    def stamp_create_wallet(self, input: CreateWalletBody) -> SignedRequest:
        """Stamp a createWallet request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_WALLET",
        }

        full_url = self.base_url + "/public/v1/submit/create_wallet"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def create_wallet_accounts(
        self, input: CreateWalletAccountsBody
    ) -> CreateWalletAccountsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_WALLET_ACCOUNTS",
        }

        return self._activity(
            "/public/v1/submit/create_wallet_accounts",
            body,
            "createWalletAccountsResult",
            CreateWalletAccountsResponse,
        )

    def stamp_create_wallet_accounts(
        self, input: CreateWalletAccountsBody
    ) -> SignedRequest:
        """Stamp a createWalletAccounts request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_CREATE_WALLET_ACCOUNTS",
        }

        full_url = self.base_url + "/public/v1/submit/create_wallet_accounts"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_api_keys(self, input: DeleteApiKeysBody) -> DeleteApiKeysResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_API_KEYS",
        }

        return self._activity(
            "/public/v1/submit/delete_api_keys",
            body,
            "deleteApiKeysResult",
            DeleteApiKeysResponse,
        )

    def stamp_delete_api_keys(self, input: DeleteApiKeysBody) -> SignedRequest:
        """Stamp a deleteApiKeys request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_API_KEYS",
        }

        full_url = self.base_url + "/public/v1/submit/delete_api_keys"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_authenticators(
        self, input: DeleteAuthenticatorsBody
    ) -> DeleteAuthenticatorsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_AUTHENTICATORS",
        }

        return self._activity(
            "/public/v1/submit/delete_authenticators",
            body,
            "deleteAuthenticatorsResult",
            DeleteAuthenticatorsResponse,
        )

    def stamp_delete_authenticators(
        self, input: DeleteAuthenticatorsBody
    ) -> SignedRequest:
        """Stamp a deleteAuthenticators request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_AUTHENTICATORS",
        }

        full_url = self.base_url + "/public/v1/submit/delete_authenticators"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_fiat_on_ramp_credential(
        self, input: DeleteFiatOnRampCredentialBody
    ) -> DeleteFiatOnRampCredentialResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_FIAT_ON_RAMP_CREDENTIAL",
        }

        return self._activity(
            "/public/v1/submit/delete_fiat_on_ramp_credential",
            body,
            "deleteFiatOnRampCredentialResult",
            DeleteFiatOnRampCredentialResponse,
        )

    def stamp_delete_fiat_on_ramp_credential(
        self, input: DeleteFiatOnRampCredentialBody
    ) -> SignedRequest:
        """Stamp a deleteFiatOnRampCredential request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_FIAT_ON_RAMP_CREDENTIAL",
        }

        full_url = self.base_url + "/public/v1/submit/delete_fiat_on_ramp_credential"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_invitation(
        self, input: DeleteInvitationBody
    ) -> DeleteInvitationResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_INVITATION",
        }

        return self._activity(
            "/public/v1/submit/delete_invitation",
            body,
            "deleteInvitationResult",
            DeleteInvitationResponse,
        )

    def stamp_delete_invitation(self, input: DeleteInvitationBody) -> SignedRequest:
        """Stamp a deleteInvitation request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_INVITATION",
        }

        full_url = self.base_url + "/public/v1/submit/delete_invitation"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_oauth2_credential(
        self, input: DeleteOauth2CredentialBody
    ) -> DeleteOauth2CredentialResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_OAUTH2_CREDENTIAL",
        }

        return self._activity(
            "/public/v1/submit/delete_oauth2_credential",
            body,
            "deleteOauth2CredentialResult",
            DeleteOauth2CredentialResponse,
        )

    def stamp_delete_oauth2_credential(
        self, input: DeleteOauth2CredentialBody
    ) -> SignedRequest:
        """Stamp a deleteOauth2Credential request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_OAUTH2_CREDENTIAL",
        }

        full_url = self.base_url + "/public/v1/submit/delete_oauth2_credential"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_oauth_providers(
        self, input: DeleteOauthProvidersBody
    ) -> DeleteOauthProvidersResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_OAUTH_PROVIDERS",
        }

        return self._activity(
            "/public/v1/submit/delete_oauth_providers",
            body,
            "deleteOauthProvidersResult",
            DeleteOauthProvidersResponse,
        )

    def stamp_delete_oauth_providers(
        self, input: DeleteOauthProvidersBody
    ) -> SignedRequest:
        """Stamp a deleteOauthProviders request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_OAUTH_PROVIDERS",
        }

        full_url = self.base_url + "/public/v1/submit/delete_oauth_providers"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_policies(self, input: DeletePoliciesBody) -> DeletePoliciesResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_POLICIES",
        }

        return self._activity(
            "/public/v1/submit/delete_policies",
            body,
            "deletePoliciesResult",
            DeletePoliciesResponse,
        )

    def stamp_delete_policies(self, input: DeletePoliciesBody) -> SignedRequest:
        """Stamp a deletePolicies request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_POLICIES",
        }

        full_url = self.base_url + "/public/v1/submit/delete_policies"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_policy(self, input: DeletePolicyBody) -> DeletePolicyResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_POLICY",
        }

        return self._activity(
            "/public/v1/submit/delete_policy",
            body,
            "deletePolicyResult",
            DeletePolicyResponse,
        )

    def stamp_delete_policy(self, input: DeletePolicyBody) -> SignedRequest:
        """Stamp a deletePolicy request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_POLICY",
        }

        full_url = self.base_url + "/public/v1/submit/delete_policy"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_private_key_tags(
        self, input: DeletePrivateKeyTagsBody
    ) -> DeletePrivateKeyTagsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_PRIVATE_KEY_TAGS",
        }

        return self._activity(
            "/public/v1/submit/delete_private_key_tags",
            body,
            "deletePrivateKeyTagsResult",
            DeletePrivateKeyTagsResponse,
        )

    def stamp_delete_private_key_tags(
        self, input: DeletePrivateKeyTagsBody
    ) -> SignedRequest:
        """Stamp a deletePrivateKeyTags request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_PRIVATE_KEY_TAGS",
        }

        full_url = self.base_url + "/public/v1/submit/delete_private_key_tags"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_private_keys(
        self, input: DeletePrivateKeysBody
    ) -> DeletePrivateKeysResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_PRIVATE_KEYS",
        }

        return self._activity(
            "/public/v1/submit/delete_private_keys",
            body,
            "deletePrivateKeysResult",
            DeletePrivateKeysResponse,
        )

    def stamp_delete_private_keys(self, input: DeletePrivateKeysBody) -> SignedRequest:
        """Stamp a deletePrivateKeys request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_PRIVATE_KEYS",
        }

        full_url = self.base_url + "/public/v1/submit/delete_private_keys"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_smart_contract_interface(
        self, input: DeleteSmartContractInterfaceBody
    ) -> DeleteSmartContractInterfaceResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_SMART_CONTRACT_INTERFACE",
        }

        return self._activity(
            "/public/v1/submit/delete_smart_contract_interface",
            body,
            "deleteSmartContractInterfaceResult",
            DeleteSmartContractInterfaceResponse,
        )

    def stamp_delete_smart_contract_interface(
        self, input: DeleteSmartContractInterfaceBody
    ) -> SignedRequest:
        """Stamp a deleteSmartContractInterface request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_SMART_CONTRACT_INTERFACE",
        }

        full_url = self.base_url + "/public/v1/submit/delete_smart_contract_interface"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_sub_organization(
        self, input: DeleteSubOrganizationBody
    ) -> DeleteSubOrganizationResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_SUB_ORGANIZATION",
        }

        return self._activity(
            "/public/v1/submit/delete_sub_organization",
            body,
            "deleteSubOrganizationResult",
            DeleteSubOrganizationResponse,
        )

    def stamp_delete_sub_organization(
        self, input: DeleteSubOrganizationBody
    ) -> SignedRequest:
        """Stamp a deleteSubOrganization request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_SUB_ORGANIZATION",
        }

        full_url = self.base_url + "/public/v1/submit/delete_sub_organization"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_user_tags(self, input: DeleteUserTagsBody) -> DeleteUserTagsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_USER_TAGS",
        }

        return self._activity(
            "/public/v1/submit/delete_user_tags",
            body,
            "deleteUserTagsResult",
            DeleteUserTagsResponse,
        )

    def stamp_delete_user_tags(self, input: DeleteUserTagsBody) -> SignedRequest:
        """Stamp a deleteUserTags request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_USER_TAGS",
        }

        full_url = self.base_url + "/public/v1/submit/delete_user_tags"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_users(self, input: DeleteUsersBody) -> DeleteUsersResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_USERS",
        }

        return self._activity(
            "/public/v1/submit/delete_users",
            body,
            "deleteUsersResult",
            DeleteUsersResponse,
        )

    def stamp_delete_users(self, input: DeleteUsersBody) -> SignedRequest:
        """Stamp a deleteUsers request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_USERS",
        }

        full_url = self.base_url + "/public/v1/submit/delete_users"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_wallet_accounts(
        self, input: DeleteWalletAccountsBody
    ) -> DeleteWalletAccountsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_WALLET_ACCOUNTS",
        }

        return self._activity(
            "/public/v1/submit/delete_wallet_accounts",
            body,
            "deleteWalletAccountsResult",
            DeleteWalletAccountsResponse,
        )

    def stamp_delete_wallet_accounts(
        self, input: DeleteWalletAccountsBody
    ) -> SignedRequest:
        """Stamp a deleteWalletAccounts request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_WALLET_ACCOUNTS",
        }

        full_url = self.base_url + "/public/v1/submit/delete_wallet_accounts"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def delete_wallets(self, input: DeleteWalletsBody) -> DeleteWalletsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_WALLETS",
        }

        return self._activity(
            "/public/v1/submit/delete_wallets",
            body,
            "deleteWalletsResult",
            DeleteWalletsResponse,
        )

    def stamp_delete_wallets(self, input: DeleteWalletsBody) -> SignedRequest:
        """Stamp a deleteWallets request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_DELETE_WALLETS",
        }

        full_url = self.base_url + "/public/v1/submit/delete_wallets"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def email_auth(self, input: EmailAuthBody) -> EmailAuthResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_EMAIL_AUTH_V3",
        }

        return self._activity(
            "/public/v1/submit/email_auth", body, "emailAuthResult", EmailAuthResponse
        )

    def stamp_email_auth(self, input: EmailAuthBody) -> SignedRequest:
        """Stamp a emailAuth request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_EMAIL_AUTH_V3",
        }

        full_url = self.base_url + "/public/v1/submit/email_auth"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def eth_send_raw_transaction(
        self, input: EthSendRawTransactionBody
    ) -> EthSendRawTransactionResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_ETH_SEND_RAW_TRANSACTION",
        }

        return self._activity(
            "/public/v1/submit/eth_send_raw_transaction",
            body,
            "ethSendRawTransactionResult",
            EthSendRawTransactionResponse,
        )

    def stamp_eth_send_raw_transaction(
        self, input: EthSendRawTransactionBody
    ) -> SignedRequest:
        """Stamp a ethSendRawTransaction request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_ETH_SEND_RAW_TRANSACTION",
        }

        full_url = self.base_url + "/public/v1/submit/eth_send_raw_transaction"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def eth_send_transaction(
        self, input: EthSendTransactionBody
    ) -> EthSendTransactionResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_ETH_SEND_TRANSACTION",
        }

        return self._activity(
            "/public/v1/submit/eth_send_transaction",
            body,
            "ethSendTransactionResult",
            EthSendTransactionResponse,
        )

    def stamp_eth_send_transaction(
        self, input: EthSendTransactionBody
    ) -> SignedRequest:
        """Stamp a ethSendTransaction request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_ETH_SEND_TRANSACTION",
        }

        full_url = self.base_url + "/public/v1/submit/eth_send_transaction"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def export_private_key(
        self, input: ExportPrivateKeyBody
    ) -> ExportPrivateKeyResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_EXPORT_PRIVATE_KEY",
        }

        return self._activity(
            "/public/v1/submit/export_private_key",
            body,
            "exportPrivateKeyResult",
            ExportPrivateKeyResponse,
        )

    def stamp_export_private_key(self, input: ExportPrivateKeyBody) -> SignedRequest:
        """Stamp a exportPrivateKey request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_EXPORT_PRIVATE_KEY",
        }

        full_url = self.base_url + "/public/v1/submit/export_private_key"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def export_wallet(self, input: ExportWalletBody) -> ExportWalletResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_EXPORT_WALLET",
        }

        return self._activity(
            "/public/v1/submit/export_wallet",
            body,
            "exportWalletResult",
            ExportWalletResponse,
        )

    def stamp_export_wallet(self, input: ExportWalletBody) -> SignedRequest:
        """Stamp a exportWallet request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_EXPORT_WALLET",
        }

        full_url = self.base_url + "/public/v1/submit/export_wallet"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def export_wallet_account(
        self, input: ExportWalletAccountBody
    ) -> ExportWalletAccountResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_EXPORT_WALLET_ACCOUNT",
        }

        return self._activity(
            "/public/v1/submit/export_wallet_account",
            body,
            "exportWalletAccountResult",
            ExportWalletAccountResponse,
        )

    def stamp_export_wallet_account(
        self, input: ExportWalletAccountBody
    ) -> SignedRequest:
        """Stamp a exportWalletAccount request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_EXPORT_WALLET_ACCOUNT",
        }

        full_url = self.base_url + "/public/v1/submit/export_wallet_account"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def import_private_key(
        self, input: ImportPrivateKeyBody
    ) -> ImportPrivateKeyResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_IMPORT_PRIVATE_KEY",
        }

        return self._activity(
            "/public/v1/submit/import_private_key",
            body,
            "importPrivateKeyResult",
            ImportPrivateKeyResponse,
        )

    def stamp_import_private_key(self, input: ImportPrivateKeyBody) -> SignedRequest:
        """Stamp a importPrivateKey request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_IMPORT_PRIVATE_KEY",
        }

        full_url = self.base_url + "/public/v1/submit/import_private_key"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def import_wallet(self, input: ImportWalletBody) -> ImportWalletResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_IMPORT_WALLET",
        }

        return self._activity(
            "/public/v1/submit/import_wallet",
            body,
            "importWalletResult",
            ImportWalletResponse,
        )

    def stamp_import_wallet(self, input: ImportWalletBody) -> SignedRequest:
        """Stamp a importWallet request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_IMPORT_WALLET",
        }

        full_url = self.base_url + "/public/v1/submit/import_wallet"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def init_fiat_on_ramp(self, input: InitFiatOnRampBody) -> InitFiatOnRampResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_INIT_FIAT_ON_RAMP",
        }

        return self._activity(
            "/public/v1/submit/init_fiat_on_ramp",
            body,
            "initFiatOnRampResult",
            InitFiatOnRampResponse,
        )

    def stamp_init_fiat_on_ramp(self, input: InitFiatOnRampBody) -> SignedRequest:
        """Stamp a initFiatOnRamp request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_INIT_FIAT_ON_RAMP",
        }

        full_url = self.base_url + "/public/v1/submit/init_fiat_on_ramp"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def init_import_private_key(
        self, input: InitImportPrivateKeyBody
    ) -> InitImportPrivateKeyResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_INIT_IMPORT_PRIVATE_KEY",
        }

        return self._activity(
            "/public/v1/submit/init_import_private_key",
            body,
            "initImportPrivateKeyResult",
            InitImportPrivateKeyResponse,
        )

    def stamp_init_import_private_key(
        self, input: InitImportPrivateKeyBody
    ) -> SignedRequest:
        """Stamp a initImportPrivateKey request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_INIT_IMPORT_PRIVATE_KEY",
        }

        full_url = self.base_url + "/public/v1/submit/init_import_private_key"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def init_import_wallet(
        self, input: InitImportWalletBody
    ) -> InitImportWalletResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_INIT_IMPORT_WALLET",
        }

        return self._activity(
            "/public/v1/submit/init_import_wallet",
            body,
            "initImportWalletResult",
            InitImportWalletResponse,
        )

    def stamp_init_import_wallet(self, input: InitImportWalletBody) -> SignedRequest:
        """Stamp a initImportWallet request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_INIT_IMPORT_WALLET",
        }

        full_url = self.base_url + "/public/v1/submit/init_import_wallet"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def init_otp(self, input: InitOtpBody) -> InitOtpResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_INIT_OTP_V2",
        }

        return self._activity(
            "/public/v1/submit/init_otp", body, "initOtpResult", InitOtpResponse
        )

    def stamp_init_otp(self, input: InitOtpBody) -> SignedRequest:
        """Stamp a initOtp request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_INIT_OTP_V2",
        }

        full_url = self.base_url + "/public/v1/submit/init_otp"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def init_otp_auth(self, input: InitOtpAuthBody) -> InitOtpAuthResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_INIT_OTP_AUTH_V3",
        }

        return self._activity(
            "/public/v1/submit/init_otp_auth",
            body,
            "initOtpAuthResultV2",
            InitOtpAuthResponse,
        )

    def stamp_init_otp_auth(self, input: InitOtpAuthBody) -> SignedRequest:
        """Stamp a initOtpAuth request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_INIT_OTP_AUTH_V3",
        }

        full_url = self.base_url + "/public/v1/submit/init_otp_auth"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def init_user_email_recovery(
        self, input: InitUserEmailRecoveryBody
    ) -> InitUserEmailRecoveryResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_INIT_USER_EMAIL_RECOVERY_V2",
        }

        return self._activity(
            "/public/v1/submit/init_user_email_recovery",
            body,
            "initUserEmailRecoveryResult",
            InitUserEmailRecoveryResponse,
        )

    def stamp_init_user_email_recovery(
        self, input: InitUserEmailRecoveryBody
    ) -> SignedRequest:
        """Stamp a initUserEmailRecovery request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_INIT_USER_EMAIL_RECOVERY_V2",
        }

        full_url = self.base_url + "/public/v1/submit/init_user_email_recovery"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def oauth(self, input: OauthBody) -> OauthResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_OAUTH",
        }

        return self._activity(
            "/public/v1/submit/oauth", body, "oauthResult", OauthResponse
        )

    def stamp_oauth(self, input: OauthBody) -> SignedRequest:
        """Stamp a oauth request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_OAUTH",
        }

        full_url = self.base_url + "/public/v1/submit/oauth"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def oauth2_authenticate(
        self, input: Oauth2AuthenticateBody
    ) -> Oauth2AuthenticateResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_OAUTH2_AUTHENTICATE",
        }

        return self._activity(
            "/public/v1/submit/oauth2_authenticate",
            body,
            "oauth2AuthenticateResult",
            Oauth2AuthenticateResponse,
        )

    def stamp_oauth2_authenticate(self, input: Oauth2AuthenticateBody) -> SignedRequest:
        """Stamp a oauth2Authenticate request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_OAUTH2_AUTHENTICATE",
        }

        full_url = self.base_url + "/public/v1/submit/oauth2_authenticate"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def oauth_login(self, input: OauthLoginBody) -> OauthLoginResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_OAUTH_LOGIN",
        }

        return self._activity(
            "/public/v1/submit/oauth_login",
            body,
            "oauthLoginResult",
            OauthLoginResponse,
        )

    def stamp_oauth_login(self, input: OauthLoginBody) -> SignedRequest:
        """Stamp a oauthLogin request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_OAUTH_LOGIN",
        }

        full_url = self.base_url + "/public/v1/submit/oauth_login"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def otp_auth(self, input: OtpAuthBody) -> OtpAuthResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_OTP_AUTH",
        }

        return self._activity(
            "/public/v1/submit/otp_auth", body, "otpAuthResult", OtpAuthResponse
        )

    def stamp_otp_auth(self, input: OtpAuthBody) -> SignedRequest:
        """Stamp a otpAuth request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_OTP_AUTH",
        }

        full_url = self.base_url + "/public/v1/submit/otp_auth"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def otp_login(self, input: OtpLoginBody) -> OtpLoginResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_OTP_LOGIN",
        }

        return self._activity(
            "/public/v1/submit/otp_login", body, "otpLoginResult", OtpLoginResponse
        )

    def stamp_otp_login(self, input: OtpLoginBody) -> SignedRequest:
        """Stamp a otpLogin request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_OTP_LOGIN",
        }

        full_url = self.base_url + "/public/v1/submit/otp_login"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def recover_user(self, input: RecoverUserBody) -> RecoverUserResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_RECOVER_USER",
        }

        return self._activity(
            "/public/v1/submit/recover_user",
            body,
            "recoverUserResult",
            RecoverUserResponse,
        )

    def stamp_recover_user(self, input: RecoverUserBody) -> SignedRequest:
        """Stamp a recoverUser request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_RECOVER_USER",
        }

        full_url = self.base_url + "/public/v1/submit/recover_user"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def reject_activity(self, input: RejectActivityBody) -> RejectActivityResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_REJECT_ACTIVITY",
        }

        return self._activity_decision(
            "/public/v1/submit/reject_activity", body, RejectActivityResponse
        )

    def stamp_reject_activity(self, input: RejectActivityBody) -> SignedRequest:
        """Stamp a rejectActivity request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_REJECT_ACTIVITY",
        }

        full_url = self.base_url + "/public/v1/submit/reject_activity"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY_DECISION
        )

    def remove_organization_feature(
        self, input: RemoveOrganizationFeatureBody
    ) -> RemoveOrganizationFeatureResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_REMOVE_ORGANIZATION_FEATURE",
        }

        return self._activity(
            "/public/v1/submit/remove_organization_feature",
            body,
            "removeOrganizationFeatureResult",
            RemoveOrganizationFeatureResponse,
        )

    def stamp_remove_organization_feature(
        self, input: RemoveOrganizationFeatureBody
    ) -> SignedRequest:
        """Stamp a removeOrganizationFeature request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_REMOVE_ORGANIZATION_FEATURE",
        }

        full_url = self.base_url + "/public/v1/submit/remove_organization_feature"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def set_organization_feature(
        self, input: SetOrganizationFeatureBody
    ) -> SetOrganizationFeatureResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_SET_ORGANIZATION_FEATURE",
        }

        return self._activity(
            "/public/v1/submit/set_organization_feature",
            body,
            "setOrganizationFeatureResult",
            SetOrganizationFeatureResponse,
        )

    def stamp_set_organization_feature(
        self, input: SetOrganizationFeatureBody
    ) -> SignedRequest:
        """Stamp a setOrganizationFeature request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_SET_ORGANIZATION_FEATURE",
        }

        full_url = self.base_url + "/public/v1/submit/set_organization_feature"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def sign_raw_payload(self, input: SignRawPayloadBody) -> SignRawPayloadResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_SIGN_RAW_PAYLOAD_V2",
        }

        return self._activity(
            "/public/v1/submit/sign_raw_payload",
            body,
            "signRawPayloadResult",
            SignRawPayloadResponse,
        )

    def stamp_sign_raw_payload(self, input: SignRawPayloadBody) -> SignedRequest:
        """Stamp a signRawPayload request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_SIGN_RAW_PAYLOAD_V2",
        }

        full_url = self.base_url + "/public/v1/submit/sign_raw_payload"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def sign_raw_payloads(self, input: SignRawPayloadsBody) -> SignRawPayloadsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_SIGN_RAW_PAYLOADS",
        }

        return self._activity(
            "/public/v1/submit/sign_raw_payloads",
            body,
            "signRawPayloadsResult",
            SignRawPayloadsResponse,
        )

    def stamp_sign_raw_payloads(self, input: SignRawPayloadsBody) -> SignedRequest:
        """Stamp a signRawPayloads request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_SIGN_RAW_PAYLOADS",
        }

        full_url = self.base_url + "/public/v1/submit/sign_raw_payloads"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def sign_transaction(self, input: SignTransactionBody) -> SignTransactionResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_SIGN_TRANSACTION_V2",
        }

        return self._activity(
            "/public/v1/submit/sign_transaction",
            body,
            "signTransactionResult",
            SignTransactionResponse,
        )

    def stamp_sign_transaction(self, input: SignTransactionBody) -> SignedRequest:
        """Stamp a signTransaction request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_SIGN_TRANSACTION_V2",
        }

        full_url = self.base_url + "/public/v1/submit/sign_transaction"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def stamp_login(self, input: StampLoginBody) -> StampLoginResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_STAMP_LOGIN",
        }

        return self._activity(
            "/public/v1/submit/stamp_login",
            body,
            "stampLoginResult",
            StampLoginResponse,
        )

    def stamp_stamp_login(self, input: StampLoginBody) -> SignedRequest:
        """Stamp a stampLogin request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_STAMP_LOGIN",
        }

        full_url = self.base_url + "/public/v1/submit/stamp_login"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def update_fiat_on_ramp_credential(
        self, input: UpdateFiatOnRampCredentialBody
    ) -> UpdateFiatOnRampCredentialResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_FIAT_ON_RAMP_CREDENTIAL",
        }

        return self._activity(
            "/public/v1/submit/update_fiat_on_ramp_credential",
            body,
            "updateFiatOnRampCredentialResult",
            UpdateFiatOnRampCredentialResponse,
        )

    def stamp_update_fiat_on_ramp_credential(
        self, input: UpdateFiatOnRampCredentialBody
    ) -> SignedRequest:
        """Stamp a updateFiatOnRampCredential request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_FIAT_ON_RAMP_CREDENTIAL",
        }

        full_url = self.base_url + "/public/v1/submit/update_fiat_on_ramp_credential"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def update_oauth2_credential(
        self, input: UpdateOauth2CredentialBody
    ) -> UpdateOauth2CredentialResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_OAUTH2_CREDENTIAL",
        }

        return self._activity(
            "/public/v1/submit/update_oauth2_credential",
            body,
            "updateOauth2CredentialResult",
            UpdateOauth2CredentialResponse,
        )

    def stamp_update_oauth2_credential(
        self, input: UpdateOauth2CredentialBody
    ) -> SignedRequest:
        """Stamp a updateOauth2Credential request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_OAUTH2_CREDENTIAL",
        }

        full_url = self.base_url + "/public/v1/submit/update_oauth2_credential"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def update_policy(self, input: UpdatePolicyBody) -> UpdatePolicyResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_POLICY_V2",
        }

        return self._activity(
            "/public/v1/submit/update_policy",
            body,
            "updatePolicyResultV2",
            UpdatePolicyResponse,
        )

    def stamp_update_policy(self, input: UpdatePolicyBody) -> SignedRequest:
        """Stamp a updatePolicy request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_POLICY_V2",
        }

        full_url = self.base_url + "/public/v1/submit/update_policy"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def update_private_key_tag(
        self, input: UpdatePrivateKeyTagBody
    ) -> UpdatePrivateKeyTagResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_PRIVATE_KEY_TAG",
        }

        return self._activity(
            "/public/v1/submit/update_private_key_tag",
            body,
            "updatePrivateKeyTagResult",
            UpdatePrivateKeyTagResponse,
        )

    def stamp_update_private_key_tag(
        self, input: UpdatePrivateKeyTagBody
    ) -> SignedRequest:
        """Stamp a updatePrivateKeyTag request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_PRIVATE_KEY_TAG",
        }

        full_url = self.base_url + "/public/v1/submit/update_private_key_tag"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def update_root_quorum(
        self, input: UpdateRootQuorumBody
    ) -> UpdateRootQuorumResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_ROOT_QUORUM",
        }

        return self._activity(
            "/public/v1/submit/update_root_quorum",
            body,
            "updateRootQuorumResult",
            UpdateRootQuorumResponse,
        )

    def stamp_update_root_quorum(self, input: UpdateRootQuorumBody) -> SignedRequest:
        """Stamp a updateRootQuorum request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_ROOT_QUORUM",
        }

        full_url = self.base_url + "/public/v1/submit/update_root_quorum"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def update_user(self, input: UpdateUserBody) -> UpdateUserResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_USER",
        }

        return self._activity(
            "/public/v1/submit/update_user",
            body,
            "updateUserResult",
            UpdateUserResponse,
        )

    def stamp_update_user(self, input: UpdateUserBody) -> SignedRequest:
        """Stamp a updateUser request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_USER",
        }

        full_url = self.base_url + "/public/v1/submit/update_user"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def update_user_email(self, input: UpdateUserEmailBody) -> UpdateUserEmailResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_USER_EMAIL",
        }

        return self._activity(
            "/public/v1/submit/update_user_email",
            body,
            "updateUserEmailResult",
            UpdateUserEmailResponse,
        )

    def stamp_update_user_email(self, input: UpdateUserEmailBody) -> SignedRequest:
        """Stamp a updateUserEmail request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_USER_EMAIL",
        }

        full_url = self.base_url + "/public/v1/submit/update_user_email"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def update_user_name(self, input: UpdateUserNameBody) -> UpdateUserNameResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_USER_NAME",
        }

        return self._activity(
            "/public/v1/submit/update_user_name",
            body,
            "updateUserNameResult",
            UpdateUserNameResponse,
        )

    def stamp_update_user_name(self, input: UpdateUserNameBody) -> SignedRequest:
        """Stamp a updateUserName request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_USER_NAME",
        }

        full_url = self.base_url + "/public/v1/submit/update_user_name"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def update_user_phone_number(
        self, input: UpdateUserPhoneNumberBody
    ) -> UpdateUserPhoneNumberResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_USER_PHONE_NUMBER",
        }

        return self._activity(
            "/public/v1/submit/update_user_phone_number",
            body,
            "updateUserPhoneNumberResult",
            UpdateUserPhoneNumberResponse,
        )

    def stamp_update_user_phone_number(
        self, input: UpdateUserPhoneNumberBody
    ) -> SignedRequest:
        """Stamp a updateUserPhoneNumber request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_USER_PHONE_NUMBER",
        }

        full_url = self.base_url + "/public/v1/submit/update_user_phone_number"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def update_user_tag(self, input: UpdateUserTagBody) -> UpdateUserTagResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_USER_TAG",
        }

        return self._activity(
            "/public/v1/submit/update_user_tag",
            body,
            "updateUserTagResult",
            UpdateUserTagResponse,
        )

    def stamp_update_user_tag(self, input: UpdateUserTagBody) -> SignedRequest:
        """Stamp a updateUserTag request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_USER_TAG",
        }

        full_url = self.base_url + "/public/v1/submit/update_user_tag"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def update_wallet(self, input: UpdateWalletBody) -> UpdateWalletResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_WALLET",
        }

        return self._activity(
            "/public/v1/submit/update_wallet",
            body,
            "updateWalletResult",
            UpdateWalletResponse,
        )

    def stamp_update_wallet(self, input: UpdateWalletBody) -> SignedRequest:
        """Stamp a updateWallet request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_UPDATE_WALLET",
        }

        full_url = self.base_url + "/public/v1/submit/update_wallet"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def verify_otp(self, input: VerifyOtpBody) -> VerifyOtpResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_VERIFY_OTP",
        }

        return self._activity(
            "/public/v1/submit/verify_otp", body, "verifyOtpResult", VerifyOtpResponse
        )

    def stamp_verify_otp(self, input: VerifyOtpBody) -> SignedRequest:
        """Stamp a verifyOtp request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)
        timestamp_ms = input_dict.pop("timestampMs", str(int(time.time() * 1000)))

        body = {
            "parameters": input_dict,
            "organizationId": organization_id,
            "timestampMs": timestamp_ms,
            "type": "ACTIVITY_TYPE_VERIFY_OTP",
        }

        full_url = self.base_url + "/public/v1/submit/verify_otp"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.ACTIVITY
        )

    def test_rate_limits(self, input: TestRateLimitsBody) -> TestRateLimitsResponse:
        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        return self._request(
            "/tkhq/api/v1/test_rate_limits", body, TestRateLimitsResponse
        )

    def stamp_test_rate_limits(self, input: TestRateLimitsBody) -> SignedRequest:
        """Stamp a testRateLimits request without sending it."""

        # Convert Pydantic model to dict
        input_dict = input.model_dump(by_alias=True, exclude_none=True)

        organization_id = input_dict.pop("organizationId", self.organization_id)

        body = {"organizationId": organization_id, **input_dict}

        full_url = self.base_url + "/tkhq/api/v1/test_rate_limits"
        body_str = self._serialize_body(body)
        stamp = self.stamper.stamp(body_str)

        return SignedRequest(
            url=full_url, body=body_str, stamp=stamp, type=RequestType.QUERY
        )
